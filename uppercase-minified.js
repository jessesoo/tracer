function waitUntilLoaded(e){setTimeout((()=>{document.querySelector(".loading-container")?waitUntilLoaded(e):e()}),100)}function main({start:e=1,stop:t=null}={}){const n=document.querySelectorAll(".image-card");if(0===n.length)return void alert("Please refresh the page.");const o=n[Math.max(0,e-1)];o.classList.contains("actived")?go({stop:t}):(o.click(),waitUntilLoaded((()=>{go({stop:t})})))}function getActiveIndex(){const e=getImageCards().findIndex((e=>e.classList.contains("actived")));return-1===e?null:e}function getImageCards(){return Array.from(document.querySelectorAll(".image-card"))}function next(){document.querySelector(".bottom-action").childNodes[1].childNodes[2].click()}function save(){document.querySelector(".bottom-action").childNodes[0].click()}function hasMore(){const e=getImageCards();return e.length>0&&!e[e.length-1].classList.contains("actived")}function done(){alert("Done.")}let cancel=!1;function go({stop:e}={}){const t=getActiveIndex();Array.from(document.querySelectorAll(".target-input")).forEach((e=>{""!=e.value&&(e.value=e.value.toUpperCase(),e.dispatchEvent(new Event("input",{bubbles:!0})))})),save(),waitUntilLoaded((()=>{null==e||t!==e-1?(next(),waitUntilLoaded((()=>{cancel||!hasMore()?done():go({stop:e})}))):done()}))}window.addEventListener("keydown",(e=>{"Escape"===e.code&&(cancel=!0)}),!0),main({start:1,stop:null});
