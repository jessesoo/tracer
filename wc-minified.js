function waitUntilLoaded(t){setTimeout((()=>{document.querySelector(".loading-container")?waitUntilLoaded(t):t()}),100)}function main(){const t=document.querySelector(".image-card");t?t.classList.contains("actived")?go():(t.click(),waitUntilLoaded(go)):alert("Please refresh the page.")}function next(){document.querySelector(".bottom-action").childNodes[1].childNodes[2].click()}function download(t,e){const n=document.createElement("a");n.href=encodeURI("data:text/csv;charset=utf-8,"+t),n.target="_blank",n.download=`${e} (⌚).csv`,document.body.appendChild(n),n.click()}function downloadFile({sources:t,translations:e}={}){const n=document.querySelector(".episode-title").textContent;let o="ZH⌚EN\n";const a={zh:0,en:0};for(let n=0;n<e.length;n++){const c=t[n][0].split("\n"),l=e[n][0].split("\n"),r=Math.max(c.length,l.length);for(let t=0;t<r;t++){const e=t<c.length?c[t]:"",n=t<l.length?l[t]:"";o+=`${e}⌚${n}\n`,a.zh+=match(e,/[\p{sc=Han}]{1}/gu),a.zh+=match(e,/\w+/g),a.en+=match(n,/\w+/g)}}o+=`${a.zh}⌚${a.en}\n`,download(o,n),alert(`${a.zh} (Chinese), ${a.en} (English). Summary will be downloaded.`)}function match(t,e){const n=t.match(e);return n?n.length:0}function getImageCards(){return Array.from(document.querySelectorAll(".image-card"))}function hasMore(){const t=getImageCards();return t.length>0&&!t[t.length-1].classList.contains("actived")}function go({sources:t=[],translations:e=[]}={}){Array.from(document.querySelectorAll(".target-input")).forEach((t=>{e.push([t.value])})),Array.from(document.querySelectorAll(".source-input")).forEach((e=>{t.push([e.value])}));const n={sources:t,translations:e};next(),waitUntilLoaded((()=>{hasMore()?go(n):downloadFile(n)}))}main();
